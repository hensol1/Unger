import React, { useState, useEffect } from 'react';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar } from 'recharts';
import { TrendingUp, TrendingDown, Minus, Shield, Target, AlertTriangle } from 'lucide-react';

const RonUngerAnalysis = () => {
  const [activeTab, setActiveTab] = useState('overview');

  // Ron Unger's stats
  const ronUnger = {
    rank: 91,
    player: "Ron Unger",
    position: "Right Back",
    team: "Maccabi Bnei Raina",
    gamesPlayed: 10,
    minutes: 776,
    age: 23,
    tackles: 1.16,
    tacklePercent: 25.0,
    clearances: 2.32,
    interceptions: 1.39,
    shotBlocks: 0.12,
    duels: 8.81,
    duelPercent: 48.7,
    aerials: 1.97,
    aerialPercent: 52.9,
    recovery: 3.60,
    errors: 0.00,
    crossBlocked: 0.12
  };

  // Comparison data with league averages (calculated from the dataset)
  const leagueAverages = {
    tackles: 2.05,
    tacklePercent: 45.8,
    clearances: 2.31,
    interceptions: 1.22,
    shotBlocks: 0.35,
    duels: 8.89,
    duelPercent: 52.1,
    aerials: 2.13,
    aerialPercent: 50.2,
    recovery: 4.12
  };

  const comparisonData = [
    { metric: 'Tackles/Game', ronUnger: 1.16, average: 2.05, percentile: 10 },
    { metric: 'Tackle %', ronUnger: 25.0, average: 45.8, percentile: 6 },
    { metric: 'Clearances', ronUnger: 2.32, average: 2.31, percentile: 50 },
    { metric: 'Interceptions', ronUnger: 1.39, average: 1.22, percentile: 65 },
    { metric: 'Duels Won %', ronUnger: 48.7, average: 52.1, percentile: 35 },
    { metric: 'Aerial %', ronUnger: 52.9, average: 50.2, percentile: 55 },
    { metric: 'Recovery', ronUnger: 3.60, average: 4.12, percentile: 25 }
  ];

  const radarData = [
    { subject: 'Tackling', value: 25, fullMark: 100 },
    { subject: 'Clearances', value: 50, fullMark: 100 },
    { subject: 'Interceptions', value: 65, fullMark: 100 },
    { subject: 'Duels', value: 35, fullMark: 100 },
    { subject: 'Aerials', value: 55, fullMark: 100 },
    { subject: 'Recovery', value: 25, fullMark: 100 }
  ];

  const strengthsWeaknesses = {
    strengths: [
      { area: "Interceptions", value: "1.39 per game (Above average)", icon: <Target className="w-4 h-4 text-green-500" /> },
      { area: "Aerial Duels", value: "52.9% success rate", icon: <TrendingUp className="w-4 h-4 text-green-500" /> },
      { area: "Error-Free", value: "0 errors leading to shots", icon: <Shield className="w-4 h-4 text-green-500" /> },
      { area: "Clearances", value: "2.32 per game (League average)", icon: <Minus className="w-4 h-4 text-yellow-500" /> }
    ],
    weaknesses: [
      { area: "Tackle Success Rate", value: "Only 25% (Very low)", icon: <TrendingDown className="w-4 h-4 text-red-500" /> },
      { area: "Tackles Per Game", value: "1.16 (Well below average)", icon: <TrendingDown className="w-4 h-4 text-red-500" /> },
      { area: "Ball Recovery", value: "3.60 per game (Below average)", icon: <TrendingDown className="w-4 h-4 text-red-500" /> },
      { area: "Overall Duel Success", value: "48.7% (Below average)", icon: <AlertTriangle className="w-4 h-4 text-orange-500" /> }
    ]
  };

  return (
    <div className="w-full max-w-6xl mx-auto p-6 bg-gray-50 min-h-screen">
      <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
        <div className="flex items-center justify-between mb-4">
          <div>
            <h1 className="text-3xl font-bold text-gray-800">Ron Unger</h1>
            <p className="text-lg text-gray-600">Right Back • Maccabi Bnei Raina • Age 23</p>
            <p className="text-sm text-gray-500">Ranked #91 in broader dataset • Position in this file: Near bottom</p>
          </div>
          <div className="text-right">
            <div className="text-2xl font-bold text-blue-600">{ronUnger.gamesPlayed} Games</div>
            <div className="text-sm text-gray-500">{ronUnger.minutes} Minutes Played</div>
          </div>
        </div>
        
        <div className="flex space-x-2 mb-6">
          {['overview', 'comparison', 'radar'].map((tab) => (
            <button
              key={tab}
              onClick={() => setActiveTab(tab)}
              className={`px-4 py-2 rounded-lg capitalize ${
                activeTab === tab
                  ? 'bg-blue-500 text-white'
                  : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
              }`}
            >
              {tab === 'radar' ? 'Performance Radar' : tab}
            </button>
          ))}
        </div>

        {activeTab === 'overview' && (
          <div className="grid md:grid-cols-2 gap-6">
            <div className="bg-green-50 rounded-lg p-4">
              <h3 className="text-lg font-semibold text-green-800 mb-3 flex items-center">
                <TrendingUp className="w-5 h-5 mr-2" />
                Strengths
              </h3>
              <div className="space-y-3">
                {strengthsWeaknesses.strengths.map((strength, index) => (
                  <div key={index} className="flex items-start space-x-3">
                    {strength.icon}
                    <div>
                      <div className="font-medium text-gray-800">{strength.area}</div>
                      <div className="text-sm text-gray-600">{strength.value}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            <div className="bg-red-50 rounded-lg p-4">
              <h3 className="text-lg font-semibold text-red-800 mb-3 flex items-center">
                <TrendingDown className="w-5 h-5 mr-2" />
                Areas for Improvement
              </h3>
              <div className="space-y-3">
                {strengthsWeaknesses.weaknesses.map((weakness, index) => (
                  <div key={index} className="flex items-start space-x-3">
                    {weakness.icon}
                    <div>
                      <div className="font-medium text-gray-800">{weakness.area}</div>
                      <div className="text-sm text-gray-600">{weakness.value}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        )}

        {activeTab === 'comparison' && (
          <div>
            <h3 className="text-xl font-semibold mb-4">Performance vs League Average</h3>
            <ResponsiveContainer width="100%" height={400}>
              <BarChart data={comparisonData}>
                <CartesianGrid strokeDasharray="3 3" />
                <XAxis dataKey="metric" angle={-45} textAnchor="end" height={100} />
                <YAxis />
                <Tooltip />
                <Legend />
                <Bar dataKey="ronUnger" fill="#3B82F6" name="Ron Unger" />
                <Bar dataKey="average" fill="#94A3B8" name="League Average" />
              </BarChart>
            </ResponsiveContainer>
          </div>
        )}

        {activeTab === 'radar' && (
          <div>
            <h3 className="text-xl font-semibold mb-4">Defensive Performance Radar (Percentiles)</h3>
            <ResponsiveContainer width="100%" height={400}>
              <RadarChart data={radarData}>
                <PolarGrid />
                <PolarAngleAxis dataKey="subject" />
                <PolarRadiusAxis angle={90} domain={[0, 100]} />
                <Radar
                  name="Ron Unger"
                  dataKey="value"
                  stroke="#3B82F6"
                  fill="#3B82F6"
                  fillOpacity={0.3}
                />
              </RadarChart>
            </ResponsiveContainer>
            <p className="text-sm text-gray-600 mt-2">
              *Values represent percentile ranking among all defensive players (0-100)
            </p>
          </div>
        )}
      </div>

      <div className="bg-white rounded-lg shadow-lg p-6">
        <h3 className="text-xl font-semibold mb-4">Key Insights & Recommendations</h3>
        <div className="grid md:grid-cols-2 gap-6">
          <div>
            <h4 className="font-semibold text-gray-800 mb-2">Playing Style Analysis</h4>
            <ul className="text-sm text-gray-600 space-y-2">
              <li>• More of a positional defender who relies on reading the game</li>
              <li>• Struggles in direct confrontations (low tackle success)</li>
              <li>• Good at anticipating play (decent interception rate)</li>
              <li>• Reliable in the air for his position</li>
            </ul>
          </div>
          <div>
            <h4 className="font-semibmaterial text-gray-800 mb-2">Development Areas</h4>
            <ul className="text-sm text-gray-600 space-y-2">
              <li>• Focus on tackle technique and timing</li>
              <li>• Improve aggressive defensive actions</li>
              <li>• Work on ball recovery after defensive actions</li>
              <li>• Increase overall defensive intensity</li>
            </ul>
          </div>
        </div>
        
        <div className="mt-6 p-4 bg-blue-50 rounded-lg">
          <h4 className="font-semibold text-blue-800 mb-2">Overall Assessment</h4>
          <p className="text-sm text-blue-700">
            Ron Unger appears to be a young right-back who relies more on positioning and anticipation than aggressive defensive play. 
            While he shows promise in certain areas like interceptions and aerial duels, his low tackle success rate suggests he may 
            struggle in high-intensity defensive situations. At 23, there's significant room for improvement in his defensive fundamentals.
          </p>
        </div>
      </div>
    </div>
  );
};

export default RonUngerAnalysis;
